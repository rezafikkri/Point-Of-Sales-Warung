/*!
 * Point Of Sales Warung
 * Licensed under GPL (https://github.com/rezafikkri/Point-Of-Sales-Warung/blob/master/LICENSE)
 */
!function(){"use strict";const t=document.querySelector("table.table"),e=document.querySelector("a#search-product"),a=document.querySelector("span#result-status");t.querySelector("tbody").addEventListener("click",(a=>{let d=a.target;if("show-product-detail"!==d.getAttribute("id")&&(d=d.parentElement),"show-product-detail"!==d.getAttribute("id")&&(d=d.parentElement),"show-product-detail"===d.getAttribute("id")){a.preventDefault();const n=d.parentElement.parentElement.nextElementSibling;if(null!==n&&n.classList.contains("table__row-detail"))n.classList.toggle("table__row-detail--show");else{const a=d.dataset.productId,n=t.dataset.csrfName,r=t.dataset.csrfValue;t.parentElement.nextElementSibling.classList.remove("d-none"),e.classList.add("btn--disabled"),fetch("/admin/tampil_produk_detail",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:`${n}=${r}&product_id=${a}`}).finally((()=>{t.parentElement.nextElementSibling.classList.add("d-none"),e.classList.remove("btn--disabled")})).then((t=>t.json())).then((e=>{if(void 0!==e.csrf_value&&(t.dataset.csrfValue=e.csrf_value),e.product_prices.length>0){const t=document.querySelector("main.main").dataset.baseUrl;let a="";e.product_prices.forEach((t=>{var e;a+=`<li><span class="table__title">Harga Produk</span>\n                            <span class="table__information">Besaran :</span><span class="table__data">${t.besaran_produk}</span>\n                            <span class="table__information">Harga :</span><span class="table__data">\n                                ${e=parseInt(t.harga_produk),e.toLocaleString("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0})}\n                            </span></li>`}));const n=document.createElement("tr");n.classList.add("table__row-detail"),n.classList.add("table__row-detail--show"),n.innerHTML=`<td colspan="5"><ul>${a}</ul></td>\n                        <td colspan="2"><img src="${t}/dist/images/product_photo/${e.product_photo}"></td>`,d.parentElement.parentElement.after(n)}})).catch((t=>{console.error(t)}))}}})),e.addEventListener("click",(d=>{d.preventDefault();const n=document.querySelector('input[name="product_name_search"]').value,r=t.dataset.csrfName,s=t.dataset.csrfValue;if(""===n.trim())return!1;t.parentElement.nextElementSibling.classList.remove("d-none"),e.classList.add("btn--disabled"),fetch("/admin/cari_produk",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:`keyword=${n}&${r}=${s}`}).finally((()=>{t.parentElement.nextElementSibling.classList.add("d-none"),e.classList.remove("btn--disabled")})).then((t=>t.json())).then((e=>{if(void 0!==e.csrf_value&&(t.dataset.csrfValue=e.csrf_value),e.products_db.length>0){let d="";e.products_db.forEach(((t,e)=>{d+=(e+1)%2!=0?'<tr class="table__row-odd">':"<tr>",d+=`<td width="10">\n                        <div class="form-check">\n                            <input type="checkbox" name="product_id" data-create-time="${t.waktu_buat}" class="form-check-input" value="${t.produk_id}">\n                        </div>\n                    </td>\n                    <td width="10"><a href="/admin/perbaharui_produk/${t.produk_id}" title="Ubah Produk"><svg xmlns="http://www.w3.org/2000/svg" width="19" fill="currentColor" viewBox="0 0 16 16"><path d="M13.498.795l.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001z"/></svg></a></td>\n                    <td width="10"><a href="#" id="show-product-detail" data-product-id="${t.produk_id}" title="Lihat detail produk"><svg xmlns="http://www.w3.org/2000/svg" width="21" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/></svg></a></td>\n\n                    <td>${t.nama_produk}</td>\n                    <td>${t.nama_kategori_produk}</td>`,"ada"===t.status_produk?d+='<td><span class="text-green">Ada</span></td>':d+='<td><span class="text-red">Tidak Ada</span></td>',d+=`<td>${t.indo_create_time}</td></tr>`})),t.querySelector("tbody").innerHTML=d,a.innerText=`1 - ${e.products_db.length} dari ${e.product_search_total} Total produk hasil pencarian`,t.dataset.typeShow="search",t.dataset.keyword=n}else t.querySelector("tbody").innerHTML='<tr class="table__row-odd"><td colspan="7">Produk tidak ada.</td></tr>',a.innerText="0 Total produk hasil pencarian";const d=document.querySelector("span#limit-message");if(e.products_db.length===e.product_limit&&null===d){const a=document.createElement("span");a.classList.add("text-muted"),a.classList.add("d-block"),a.classList.add("mt-3"),a.setAttribute("id","limit-message"),a.innerHTML=`Hanya ${e.product_limit} Produk terbaru yang ditampilkan, Pakai fitur <i>Pencarian</i> untuk hasil lebih spesifik!`,t.after(a)}else e.products_db.length!==e.product_limit&&null!==d&&d.remove()})).catch((t=>{console.error(t)}))})),document.querySelector("a#remove-product").addEventListener("click",(d=>{d.preventDefault();const n=document.querySelectorAll('input[type="checkbox"][name="product_id"]:checked');if(0===n.length)return!1;let r="";r+=`${t.dataset.csrfName}=${t.dataset.csrfValue}`;let s="";n.forEach(((t,e)=>{e===n.length-1?s+=t.value:s+=t.value+","})),r+=`&product_ids=${s}`;const l=document.querySelectorAll('input[type="checkbox"][name="product_id"]');r+=`&smallest_create_time=${l[l.length-1].dataset.createTime}`,void 0!==t.dataset.typeShow&&void 0!==t.dataset.keyword&&(r+=`&keyword=${t.dataset.keyword}`),t.parentElement.nextElementSibling.classList.remove("d-none"),e.classList.add("btn--disabled"),fetch("/admin/hapus_produk",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:r}).finally((()=>{t.parentElement.nextElementSibling.classList.add("d-none"),e.classList.remove("btn--disabled")})).then((t=>t.json())).then((e=>{if(void 0!==e.csrf_value&&(t.dataset.csrfValue=e.csrf_value),"success"===e.status){n.forEach((t=>{const e=t.parentElement.parentElement.parentElement.nextElementSibling;null!==e&&e.classList.contains("table__row-detail")&&e.remove(),t.parentElement.parentElement.parentElement.remove()})),e.longer_products.length>0&&e.longer_products.forEach(((e,a)=>{const d=document.createElement("tr");(a+1)%2!=0&&d.classList.add("table__row-odd");let n=`<td width="10">\n                            <div class="form-check">\n                                <input type="checkbox" name="product_id" data-create-time="${e.waktu_buat}" class="form-check-input" value="${e.produk_id}">\n                            </div>\n                        </td>\n                        <td width="10"><a href="/admin/perbaharui_produk/${e.produk_id}" title="Ubah Produk"><svg xmlns="http://www.w3.org/2000/svg" width="19" fill="currentColor" viewBox="0 0 16 16"><path d="M13.498.795l.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001z"/></svg></a></td>\n                        <td width="10"><a href="#" id="show-product-detail" data-product-id="${e.produk_id}" title="Lihat detail produk"><svg xmlns="http://www.w3.org/2000/svg" width="21" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/></svg></a></td>\n\n                        <td>${e.nama_produk}</td>\n                        <td>${e.nama_kategori_produk}</td>`;"ada"===e.status_produk?n+='<td><span class="text-green">Ada</span></td>':n+='<td><span class="text-red">Tidak Ada</span></td>',n+=`<td>${e.indo_create_time}</td>`,d.innerHTML=n,t.querySelector("tbody").append(d)}));const d=t.querySelectorAll("tbody tr").length;0===e.product_total?(t.querySelector("tbody").innerHTML='<tr class="table__row-odd"><td colspan="6">Produk tidak ada.</td></tr>',void 0!==t.dataset.typeShow&&void 0!==t.dataset.keyword?a.innerText="0 Total produk hasil pencarian":a.innerText="0 Total produk"):void 0!==t.dataset.typeShow&&void 0!==t.dataset.keyword?a.innerText=`1 - ${d} dari ${e.product_total} Total produk hasil pencarian`:a.innerText=`1 - ${d} dari ${e.product_total} Total produk`;const r=document.querySelector("span#limit-message");d<e.product_limit&&null!==r&&r.remove()}else if("fail"===e.status){const t=function(t,e){const a=document.createElement("div");a.classList.add("alert");for(const e of t)a.classList.add(e);return a.innerHTML=`<span class="alert__icon"></span>\n    <p>${e}</p>\n    <a class="alert__close" href="#"></a>`,a}(["alert--warning","mb-3"],e.message);document.querySelector("main.main > div").insertBefore(t,document.querySelector("div.main__box")),n.forEach((t=>{t.checked=!1}))}})).catch((t=>{console.error(t)}))}))}();
