/*!
 * Point Of Sales Warung
 * Licensed under GPL (https://github.com/rezafikkri/Point-Of-Sales-Warung/blob/master/LICENSE)
 */
!function(){"use strict";function e(e,t){t.classList.replace("modal__content--animate-show","modal__content--animate-hide"),setTimeout((()=>{t.classList.remove("modal__content--animate-hide"),e.classList.replace("modal--fade-in","modal--fade-out")}),100),setTimeout((()=>{e.classList.remove("modal--fade-out"),e.classList.remove("modal--show"),e.classList.remove("d-block")}),200)}const t=document.querySelector("table.table"),s=document.querySelector(".modal"),a=s.querySelector(".modal__content");t.querySelector("tbody").addEventListener("click",(e=>{let t=e.target;"remove-user"!==t.getAttribute("id")&&(t=t.parentElement),"remove-user"!==t.getAttribute("id")&&(t=t.parentElement),"remove-user"===t.getAttribute("id")&&(e.preventDefault(),function(e,t){e.classList.add("d-block"),setTimeout((()=>{e.classList.add("modal--fade-in")}),50),setTimeout((()=>{t.classList.add("modal__content--animate-show")}),200)}(s,a),a.querySelector('input[name="user_id"]').value=t.dataset.userId,a.querySelector("div.modal__body p strong").innerText=t.dataset.fullName)})),a.querySelector("a#btn-close").addEventListener("click",(t=>{t.preventDefault(),e(s,a),a.querySelector('input[name="password"]').value="";const r=a.querySelector("small.form-message");null!==r&&r.remove()})),a.querySelector("a#remove-user-in-db").addEventListener("click",(r=>{r.preventDefault();const o=a.querySelector('input[name="password"]').value,n=a.querySelector('input[name="user_id"]').value,l=t.dataset.csrfName,d=t.dataset.csrfValue,i=a.querySelector("small.form-message");null!==i&&i.remove(),r.target.classList.add("btn--disabled"),r.target.nextElementSibling.classList.remove("d-none"),fetch("/admin/hapus_pengguna_di_db",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:`${l}=${d}&user_id=${n}&password=${o}`}).finally((()=>{r.target.classList.remove("btn--disabled"),r.target.nextElementSibling.classList.add("d-none")})).then((e=>e.json())).then((r=>{if(void 0!==r.csrf_value&&(t.dataset.csrfValue=r.csrf_value),"success"===r.status)document.querySelector(`tr#user${n}`).remove();else{if("wrong_password"===r.status){const e=document.createElement("small");return e.classList.add("form-message"),e.classList.add("form-message--danger"),e.innerText=r.message,a.querySelector("div.modal__body").append(e),!1}if("fail"===r.status){const e=function(e,t){const s=document.createElement("div");s.classList.add("alert");for(const t of e)s.classList.add(t);return s.innerHTML=`<span class="alert__icon"></span>\n    <p>${t}</p>\n    <a class="alert__close" href="#"></a>`,s}(["alert--warning","mb-3"],r.message);document.querySelector("main.main > div").insertBefore(e,document.querySelector("div.main__box"))}}"success"!==r.status&&"fail"!==r.status||(e(s,a),a.querySelector('input[name="password"]').value="")})).catch((e=>{console.error(e)}))})),document.querySelector(".modal a#show-password").addEventListener("click",(function(e){e.preventDefault();let t=e.target;if(/^show-password.*/.test(t.getAttribute("id"))||(t=t.parentElement),/^show-password.*/.test(t.getAttribute("id"))||(t=t.parentElement),/^show-password.*/.test(t.getAttribute("id"))){const e=t.previousElementSibling;"password"===e.getAttribute("type")?(e.setAttribute("type","text"),t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="19" fill="currentColor" viewBox="0 0 16 16"><path d="M11 1a2 2 0 0 0-2 2v4a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h5V3a3 3 0 0 1 6 0v4a.5.5 0 0 1-1 0V3a2 2 0 0 0-2-2z"/></svg>'):(e.setAttribute("type","password"),t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="19" fill="currentColor" viewBox="0 0 16 16"><path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/></svg>')}}))}();
